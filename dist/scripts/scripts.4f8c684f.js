"use strict";angular.module("demoApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","nvd3","pathgather.popeye","ngAudio"]).factory("pathService",function(){return{imagepath:"images/",profilepath:"/#/profiles/",usericonpath:"images/user_images/",depticonpath:"images/dept_icons/",leveliconpath:"images/level_icons/"}}).factory("loginService",function(){return{userId:1}}).factory("cardService",function(){var a=15;return{setModalId:function(b){return a=b},getModalId:function(){return a}}}).factory("dataService",["$http",function(a){return{getUser:function(b){return a.get("http://localhost/demo/api/users/"+b)},getCardSummary:function(b){return a.get("http://localhost/demo/api/users/"+b+"/cards/summary")},getCoreValues:function(){return a.get("corevalues.json")},getCardById:function(b){return a.get("http://localhost/demo/api/cards/"+b)},getCards:function(b,c,d,e){return a.get("http://localhost/demo/api/users/"+b+"/cards?type="+c+"&limit="+d+"&offset="+e)},getFeed:function(){return a.get("http://localhost/demo/api/events/?limit=20")},getCoreValueTypes:function(){return a.get("http://localhost/demo/api/corevaluetypes/")},getScoreboardTypes:function(){return a.get("http://localhost/demo/api/scoreboardtypes/")},getScoreboardData:function(b,c){return a.get("http://localhost/demo/api/scoreboardtypes/"+b+"?subcategoryid=0&limit="+c+"&offset=0")},sendCard:function(b){return a.post("http://localhost/demo/api/cards/",JSON.stringify(b))},readCard:function(b,c){return a.post("http://localhost/demo/api/cards/"+b+"/isread",JSON.stringify(c))}}}]).factory("slackService",["$http",function(a){return{postSentCard:function(){var b={"new-bot-name":"demo",text:"meow"};console.log(b),a.defaults.headers.common["Content-Type"]="application/x-www-form-urlencoded;charset=utf8",a({url:"https://hooks.slack.com/services/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",dataType:"json",method:"POST",data:{text:"Dude"}})}}}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main",feed:!0}).when("/homepage",{templateUrl:"views/homepage.html",controller:"LoginCtrl",controllerAs:"homepage",feed:!1}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login",feed:!1}).when("/register",{templateUrl:"views/register.html",controller:"LoginCtrl",controllerAs:"login",feed:!1}).when("/profile",{templateUrl:"views/profile.html",controller:"UserCtrl",controllerAs:"user",feed:!1}).when("/imageupload",{templateUrl:"views/imageupload.html",controller:"UserCtrl",controllerAs:"user",feed:!1}).when("/sendcard",{templateUrl:"views/sendcard.html",controller:"SendCardCtrl",controllerAs:"sendcard",feed:!1}).when("/viewcard",{templateUrl:"views/viewcard.html",controller:"CardCtrl",controllerAs:"card",feed:!1}).when("/gallery",{templateUrl:"views/gallery.html",controller:"GalleryCtrl",controllerAs:"gallery",feed:!1}).when("/scoreboard",{templateUrl:"views/scoreboard.html",controller:"ScoreboardCtrl",controllerAs:"scoreboard",feed:!1}).otherwise({redirectTo:"/"})}]),app.use("/api",function(a,b,c){b.header("Access-Control-Allow-Origin","*"),b.header("Access-Control-Allow-Headers","X-Requested-With, Content-Type"),c()}),angular.module("demoApp").controller("MainCtrl",function(){}).controller("headerCtrl",["$scope","pathService","dataService","loginService",function(a,b,c,d){var e=d.userId;a.imagepath=b.imagepath,c.getUser(e).then(function(b){a.user=b.data})}]),angular.module("demoApp").controller("CardCtrl",["$scope","pathService","dataService","cardService",function(a,b,c,d){c.getCardById(d.getModalId()).then(function(b){a.card=b.data,a.markRead=function(){var b={isRead:!0};c.readCard(a.card.cardId,b).then(function(){})},a.markRead()})}]).controller("GalleryCtrl",["$scope","dataService","loginService","$routeParams","cardService","Popeye","$timeout",function(a,b,c,d,e,f,g){function h(){a.phrase=a.sentReceived?"sent":"received",b.getUser(j).then(function(c){a.user=c.data,b.getCards(j,a.phrase,a.user.totalCardsReceived,0).then(function(b){a.cards=angular.copy(b.data.cards),console.log(a.cards)})})}function i(){f.openModal({templateUrl:"/views/cardmodal.html",containerTemplate:null,containerTemplateUrl:"/views/modal-container.html",controller:"CardCtrl as ctrl"})}a.sentReceived=!1;var j=d.id||c.userId;h(),a.$watch("sentReceived",function(a,b){console.log(b,a),h()}),a.popCard=function(a){e.setModalId(a),i(a),g(h,1e3)}}]),angular.module("demoApp").controller("SendCardCtrl",["$scope","pathService","dataService","loginService","cardService","Popeye","$location","slackService",function(a,b,c,d,e,f,g,h){var i=d.userId;c.getCoreValueTypes().then(function(b){a.coreValues=b.data,a.card={},a.card.SenderUserId=i,a.card.ReceiverUserId=2,a.card.CoreValueTypeId=1,a.card.NumCoins=500,a.card.Message="Meow!",a.card.IsFromAdmin=!1,a.sendCard=function(a){console.log(a),c.sendCard(a).success(function(a){h.postSentCard(a),e.setModalId(a.cardId),d(a.cardId),g.path("gallery")})};var d=function(){f.openModal({templateUrl:"/views/cardmodal.html",containerTemplate:null,containerTemplateUrl:"/views/modal-container.html",controller:"CardCtrl as ctrl"})}})}]),angular.module("demoApp").controller("LoginCtrl",["$scope",function(a){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.hideFeed=!0}]),angular.module("demoApp").controller("feedCtrl",["$scope","pathService","dataService","$timeout","ngAudio","slackService",function(a,b,c,d,e,f){a.imagepath=b.imagepath,a.usericonpath=b.usericonpath,function g(){c.getFeed().then(function(b){angular.equals(b.data,a.feed)||a.ding(),a.feed=b.data,angular.forEach(a.feed,function(a){null!==a.cardId&&c.getCardById(a.cardId).then(function(b){a.cardMessage=b.data.message})}),console.log(a.feed),f.postSentCard(),d(g,1e4)})}(),a.htmlToPlaintext=function(a){return a?String(a).replace(/<[^>]+>/gm,""):""},a.showMessage=function(a){c.getCardById(a).then(function(){return"meow"})},a.ding=function(){a.sound=e.load("audio/bell.mp3"),a.sound.play()}}]),angular.module("demoApp").controller("UserCtrl",["$scope","pathService","dataService","loginService","$routeParams","Popeye","cardService",function(a,b,c,d,e,f,g){function h(){f.openModal({templateUrl:"/views/cardmodal.html",containerTemplate:null,containerTemplateUrl:"/views/modal-container.html",controller:"CardCtrl as ctrl"})}var i=e.id||d.userId;a.imagepath=b.imagepath,c.getUser(i).then(function(b){a.user=b.data,a.deptIcon=b.data.department.imageUrl,a.levelIcon=b.data.level.imageUrl}),c.getCardSummary(i).then(function(b){a.userSummary=b.data,a.coreScores=[];for(var d=0;d<a.userSummary.coreValueTypeCoinBreakdown.length;d++)a.coreScores[d]={},a.coreScores[d].coins=a.userSummary.coreValueTypeCoinBreakdown[d].totalCoinsReceived,a.coreScores[d].cards=a.userSummary.coreValueTypeCoinBreakdown[d].totalCardsReceived,a.coreScores[d].coreValueName=a.userSummary.coreValueTypeCoinBreakdown[d].coreValueType.coreValueName,a.coreScores[d].coreValueImage=a.userSummary.coreValueTypeCoinBreakdown[d].coreValueType.coreValueTypeImageUrl,a.coreScores[d].coreValueId=a.userSummary.coreValueTypeCoinBreakdown[d].coreValueType.coreValueTypeId,a.coreScores[d].flagHeight=30-Math.floor(a.userSummary.coreValueTypeCoinBreakdown[d].totalCoinsReceived/a.userSummary.totalCoinsReceived*30);c.getCards(i,"received",5,0).then(function(b){a.cards=angular.copy(b.data.cards),console.log(a.cards)}),a.data=[{key:"",y:a.userSummary.coinPercentile},{key:"",y:100-a.userSummary.coinPercentile}],a.data2=[{key:"",y:a.userSummary.cardPercentile},{key:"",y:100-a.userSummary.cardPercentile}]}),a.popCard=function(a){g.setModalId(a),h(a)},a.options={chart:{type:"pieChart",height:205,donut:!0,x:function(a){return a.key},y:function(a){return a.y},showLabels:!1,pie:{startAngle:function(a){return a.startAngle/2-Math.PI/2},endAngle:function(a){return a.endAngle/2-Math.PI/2}},duration:500,legend:{margin:{top:5,right:70,bottom:5,left:0}}}}}]),angular.module("demoApp").controller("ScoreboardCtrl",["$scope","pathService","dataService",function(a,b,c){a.usericonpath=b.usericonpath,c.getScoreboardTypes().then(function(b){a.boardTypes=b.data,a.bottomBoardTypes=a.boardTypes.slice(6);var d=5;angular.forEach(a.boardTypes,function(a,b){console.log(a.scoreboardTypeName);var e=a.scoreboardTypeId;d=b>-1&&2>b?10:5,c.getScoreboardData(e,d).then(function(b){a.scoreboardData=b.data,console.log(a.scoreboardData.scoreboardEntries)})})})}]),angular.module("demoApp").run(["$templateCache",function(a){a.put("views/cardmodal.html",'<div class="modal-body core{{card.coreValueType.coreValueTypeId}}"> <div class="card-modal-card"> <div class="card-title"> {{card.coreValueType.coreValueName}} </div> <div class="card-image"> <img ng-src="{{card.coreValueType.coreValueTypeImageUrl}}"> </div> <div class="card-type"> CORE VALUE #{{card.coreValueType.coreValueTypeId}} <div class="pull-right"> <img src="images/coins_sm.e1470227.png" style="margin-top:-2px"> {{card.numCoins}} </div> </div> <div class="card-info"> <img src="{{card.sender.imageUrl}}" class="pull-left"> <div class="card-label">FROM:</div> <h4>{{card.sender.senderName}}</h4></div> <div class="card-info"> <img src="{{card.receiver.imageUrl}}" class="pull-left"> <div class="card-label">TO:</div> <h4>{{card.receiver.receiverName}}</h4></div> <div class="timestamp">Sent at {{card.createdAt}}</div> </div> <div class="card-modal-message"> <div class="card-modal-message-tip"></div> <div class="card-modal-message-body"> {{card.message}} <div class="card-modal-signature">- {{card.sender.senderName}}</div> </div> </div> </div>'),a.put("views/gallery.html",'<div class="gallery simple-page"> <div class="col-lg-10 col-lg-offset-1"> <div class="section-title" style="margin-top:18px"><h3>{{user.firstName}}\'s Core Value Card Gallery</h3> <span ng-click="sentReceived = !sentReceived">{{sentReceived === true ? "Cards You\'ve Sent" : "Cards You Received"}}</span></div> <div class="row gallery-body"> <div class="col-lg-2" ng-repeat="card in cards"> <div class="gallery-cell core{{card.coreValueType.coreValueTypeId}}"> <div class="gallery-card" ng-click="popCard(card.cardId)"> <img src="images/new-burst.61d7f280.png" style="position:absolute; top:0; left:0; height:50px; width:50px" ng-hide="card.isRead"> <div class="gallery-card-title">{{card.coreValueType.coreValueName}}</div> <div class="gallery-img-bg"></div> <img ng-src="{{card.coreValueType.coreValueTypeImageUrl}}"> <div class="gallery-card-title"><span style="font-weight:normal">CORE VALUE #{{card.coreValueType.coreValueTypeId}}</span></div> <div class="gallery-card-message">{{ card.message | limitTo: 20 }}{{card.message.length > 20 ? \'...\' : \'\'}} </div> <div class="coins">{{card.numCoins}} COINS</div> </div> <div class="bottom-text"> <span class="small-text">From:</span><br> {{card.sender.senderName}}<br> <span class="small-text">To:</span><br> {{card.receiver.receiverName}}<br> </div> </div> </div> </div> </div> <div class="clearfix"></div> </div>'),a.put("views/homepage.html",'<div class="main-background"> </div>'),a.put("views/login.html",'<div class="main-background homepage" style="height:750px"> <div class="row"> <div class="panel panel-default col-lg-6 col-lg-offset-3 col-sm-8 col-sm-offset-2 fade-in-load"> <h2 class="panel-title">Log In and Start Using demo!</h2> <div class="panel-body"> <div class="row"><div class="col-lg-8 col-lg-offset-2"> <i class="fa fa-user"></i> Username <input type="text" class="form-control" id="username"> <i class="fa fa-lock"></i> Password <input type="password" class="form-control" id="pw"> <button type="submit" class="btn btn-primary pull-right">Submit</button> <a href="/#/register">Got an invite but haven\'t logged in yet?</a> </div></div> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="main-background mainpage" style="height:750px; padding-top:480px; text-align:center"> <a href="/#/login"><button class="search-button" style="padding-top:3px">Log In</button></a> </div>'),a.put("views/modal-container.html",'<div class="popeye-modal-container" style="padding:0"> <div class="popeye-modal" style="width:750px; background-color:#958d8c; padding:0"> </div> </div>'),a.put("views/profile.html",'<div class="profile"> <div class="row"> <div class="col-lg-3 col-md-4 col-sm-12 standard-pad profile-left content" style="height:970px; padding-bottom:0"> <img ng-src="{{user.imageUrl}}" class="profile-left-pic"> <h1>{{user.firstName}} {{user.lastName}}</h1> <h4>{{user.level.levelName}}</h4> <div class="profile-job-title"> <p>{{user.jobTitle}}<br> {{user.department.departmentName}}</p> </div> <img class="iconsize" ng-src="{{deptIcon}}"> <img class="iconsize" ng-src="{{levelIcon}}"> </div> <div class="col-lg-9 col-md-8 col-sm-12 profile-stats"> <div class="section-title"> Cards & Coins Collected </div> <div class="profile-stats-top row"> <div class="col-lg-4 col-lg-offset-1"> {{userSummary.totalCoinsReceived}} <div class="text-20"> TOTAL<br> CORE VALUE<br> COINS </div> </div> <div class="col-lg-6"> <div class="pull-right profile-score"> <span class="sm-text">Your rank:</span><br> {{userSummary.coinPercentile}}% </div> <div class="pull-right profile-chart-container"> <nvd3 options="options" data="data" class="profile-chart"></nvd3> </div> </div> </div> <div class="profile-stats-middle row"> <div class="col-lg-5 col-lg-offset-1"> {{userSummary.totalCardsReceived}} <div class="text-20"> TOTAL<br> CARDS </div> </div> <div class="col-lg-5"> <div class="pull-right profile-score"> <span class="sm-text">Your rank:</span><br> {{userSummary.cardPercentile}}% </div> <div class="pull-right profile-chart-container"> <nvd3 options="options" data="data2" class="profile-chart"></nvd3> </div> </div> </div> <div class="row"> <div class="col-lg-10 col-lg-offset-1" style="padding-top:10px"> <span class="text-20">BREAKDOWN BY CORE VALUES</span> </div> </div> <div class="row"> <div class="col-lg-1"></div> <div ng-repeat="score in coreScores" class="col-lg-2"> <div class="flag"> <div class="flag-flag" ng-style="{\'background-image\': \'url(images/flags/flag_{{score.coreValueId}}.png)\', \'margin-top\': \'{{score.flagHeight}}px\'}"> <img ng-src="{{score.coreValueImage}}" height="70" style="margin-left:13px"> </div> </div> <div style="height:60px"><h4><b>{{score.coreValueName}}</b></h4></div>{{score.coins}} coins<br>{{score.cards}} cards </div> </div> <div class="row" style="padding-left:70px"> <hr> <span class="text-20">LAST 5 CARDS RECEIVED</span><br> <div style="height:25px"></div> <div class="col-lg-2" ng-repeat="card in cards"> <div class="gallery-cell core{{card.coreValueType.coreValueTypeId}}"> <div class="gallery-card" ng-click="popCard(card.cardId)"> <img src="images/new-burst.61d7f280.png" style="position:absolute; top:0; left:0; height:50px; width:50px" ng-hide="card.isRead"> <div class="gallery-card-title">{{card.coreValueType.coreValueName}}</div> <div class="gallery-img-bg"></div> <img ng-src="{{card.coreValueType.coreValueTypeImageUrl}}"> <div class="gallery-card-title"><span style="font-weight:normal">CORE VALUE #{{card.coreValueType.coreValueTypeId}}</span></div> <div class="gallery-card-message">{{ card.message | limitTo: 20 }}{{card.message.length > 20 ? \'...\' : \'\'}} </div> <div class="coins">{{card.numCoins}} COINS</div> </div> <div class="bottom-text"> <span class="small-text">From:</span><br> {{card.sender.senderName}}<br> <span class="small-text">To:</span><br> {{card.receiver.receiverName}}<br> </div> </div> </div> </div> <a class="pull-left search-button" href="#/gallery" style="margin-left:70px; margin-bottom:20px">View Gallery</a> </div> </div> </div>'),a.put("views/register.html",'<div class="main-background"> <div class="row"> <div class="panel panel-default col-lg-6 col-lg-offset-3 col-sm-8 col-sm-offset-2 fade-in-load"> <h2 class="panel-title">Enter Your Email and Invite Code to Register</h2> <div class="panel-body"> <div class="row"><div class="col-lg-8 col-lg-offset-2"> <i class="fa fa-user"></i> Email <input type="text" class="form-control" id="username"> <i class="fa fa-lock"></i> Invite Code <input type="text" class="form-control" id="invite"> <i class="fa fa-lock"></i> Desired Password <input type="password" class="form-control" id="pw"> <i class="fa fa-lock"></i> Repeat Password <input type="password" class="form-control" id="pw"> <button type="submit" class="btn btn-primary pull-right">Submit</button> </div></div> </div> </div> </div> </div>'),a.put("views/scoreboard.html",'<div class="scoreboard"> <div class="col-lg-8 col-lg-offset-2 scoreboard-sign"> <div class="row scoreboard-top"> <img src="{{boardTypes[0].scoreboardData.scoreboardEntries[0].entityImageUrl}}" class="pull-left"> <div style="display:inline-block"> <h2>{{boardTypes[0].scoreboardTypeName}}</h2> <div ng-repeat="entry in boardTypes[0].scoreboardData.scoreboardEntries | limitTo:5"> {{$index+1}}. {{entry.entityName}} ({{entry.value}}) </div> </div> <div style="display:inline-block; margin-left:30px"> <div ng-repeat="entry in boardTypes[0].scoreboardData.scoreboardEntries | limitTo:5:5"> {{$index+6}}. {{entry.entityName}} ({{entry.value}}) </div> </div> <img src="images/sign-end.df5312d2.png" class="sign-end"> </div> <div class="row scoreboard-middle"> <img src="{{boardTypes[1].scoreboardData.scoreboardEntries[0].entityImageUrl}}" class="pull-left"> <div style="display:inline-block"> <h2>{{boardTypes[1].scoreboardTypeName}}</h2> <div ng-repeat="entry in boardTypes[1].scoreboardData.scoreboardEntries | limitTo:5"> {{$index+1}}. {{entry.entityName}} ({{entry.value}}) </div> </div> <div style="display:inline-block; margin-left:30px"> <div ng-repeat="entry in boardTypes[1].scoreboardData.scoreboardEntries | limitTo:5:5"> {{$index+6}}. {{entry.entityName}} ({{entry.value}}) </div> </div> </div> <div ng-repeat="board in bottomBoardTypes" ng-if="$index % 2 == 0" class="row scoreboard-bottom"> <div class="col-lg-6"><h3>{{board.scoreboardTypeName}}</h3><img src="{{board.scoreboardData.scoreboardEntries[0].entityImageUrl}}" class="pull-left"> <span ng-repeat="entry in board.scoreboardData.scoreboardEntries"> {{$index+1}}. {{entry.entityName}} ({{entry.value}})<br> </span> </div> <div class="col-lg-6" ng-if="boardTypes.length > ($index + 1)"><h3>{{board.scoreboardTypeName}}</h3><img src="{{board.scoreboardData.scoreboardEntries[0].entityImageUrl}}" class="pull-left"> <span ng-repeat="entry in board.scoreboardData.scoreboardEntries"> {{$index+1}}. {{entry.entityName}} ({{entry.value}})<br> </span> </div> </div> </div> <div class="clearfix"></div> </div>'),a.put("views/sendcard.html",'<div class="sendcard simple-page" fixheight="true"> <div class="col-lg-8 col-lg-offset-2"> <h2 class="page-title">Send A Core Values Card!</h2> <p>Show your fellow employees some love by sending a new, improved Core Values Card! Did someone help with a project? Cover a shift for you? Help groom your cat? (That was probably Bennett.) Well then, what are you waiting for?</p> <form ng-submit="sendCard(card)"> <div class="form-group"> <label for="email">Recipient\'s Name</label> <select class="form-control" ng-model="card.ReceiverUserId"> <option value="1">Megan Duffy</option> <option value="2">Bennett Shapiro</option> <option value="3">Chad Lineberry</option> <option value="4">Tony Burian</option> <option value="5">Rob Clark</option> <option value="6">Maribeth Homa</option> </select> </div> <div class="form-group"> <label for="coreValue">Select A Core Value:</label> <select class="form-control" id="coreValue" ng-model="card.CoreValueTypeId"> <option ng-repeat="value in coreValues" value="{{$index+1}}">{{value.coreValueName}}</option> </select> </div> <div class="form-group"> <label for="coins">How Many Coins to Add?</label> <input type="text" class="form-control" id="coins" ng-model="card.NumCoins"> </div> <div class="form-group"> <label>Write Your Message Here</label><br> <textarea name="comment" form="usrform" ng-model="card.Message" style="width:100%; height:150px"></textarea> </div> <button type="submit" class="btn btn-default">Submit</button> </form> </div> <div class="clearfix"></div> </div>'),a.put("views/viewcard.html",'<div class="main-background"> </div>')}]);